/**
 * Yokin's FlashAir Javascript client library type definitions
 * (c) 2015 Yokinsoft Jake.Y.Yoshimura http://www.yo-ki.com
 *
 * @version 0.9.5
 * @author Yokinsoft Jake.Y.Yoshimura
 * @license MIT License
 */
var FlashAir;!function(t){!function(t){t[t.ReadOnly=1]="ReadOnly",t[t.Hidden=2]="Hidden",t[t.System=4]="System",t[t.Volume=8]="Volume",t[t.Directory=16]="Directory",t[t.Archive=32]="Archive"}(t.FileAttribute||(t.FileAttribute={}));var e=(t.FileAttribute,function(){function t(){}return t.prototype.Directory=function(){return this.r_uri},t.prototype.Name=function(){return this.fname},t.prototype.Size=function(){return this.fsize},t.prototype.Time=function(){return t.FTIMEtoDateTime(this.fdate,this.ftime)},t.prototype.Attributes=function(){return this.attr},t.prototype.IsDirectory=function(){return!!(16&this.attr)},t.FTIMEtoDateTime=function(t,e){return new Date(1980+(t>>9&127),(t>>5&15)-1,31&t,e>>11&31,e>>5&63,e<<1&63)},t.DateTimeToFDATE=function(t){return(t.getUTCFullYear()-1980<<9)+(t.getMonth()-1<<5)+t.getDay()},t.DateTimeToFTIME=function(t){return(t.getHours()<<11)+(t.getMinutes()<<5)+(t.getSeconds()>>1)},t}());t.FileInfo=e,function(t){t[t.Disabled=0]="Disabled",t[t.ReadOnly=1]="ReadOnly",t[t.ReadWrite=2]="ReadWrite"}(t.WebDAVStatus||(t.WebDAVStatus={}));t.WebDAVStatus;!function(t){t[t.Horizontal=1]="Horizontal",t[t.MirrorHorizontal=2]="MirrorHorizontal",t[t.Rotate180=3]="Rotate180",t[t.MirrorVertical=4]="MirrorVertical",t[t.MirrorHhorizontalAndRotate270CW=5]="MirrorHhorizontalAndRotate270CW",t[t.Rotate90CW=6]="Rotate90CW",t[t.MirrorHorizontalAndRotate90CW=7]="MirrorHorizontalAndRotate90CW",t[t.Rotate270CW=8]="Rotate270CW"}(t.ExifOientation||(t.ExifOientation={}));t.ExifOientation;!function(t){t[t.AccessPointDeferred=0]="AccessPointDeferred",t[t.StationDeferred=2]="StationDeferred",t[t.BridgeDeferred=3]="BridgeDeferred",t[t.AccessPoint=4]="AccessPoint",t[t.Station=5]="Station",t[t.Bridge=6]="Bridge"}(t.WiFiOperationMode||(t.WiFiOperationMode={}));var n=(t.WiFiOperationMode,function(){function t(){}return t.prototype.on=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},t.prototype.addEventListener=function(t,e){},t.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return this.on(t,n),this},t.prototype.off=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[t];if(!n)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===e||r.fn===e){n.splice(o,1);break}return this},t.prototype.removeListener=function(t,e){},t.prototype.removeAllListeners=function(t,e){},t.prototype.removeEventListener=function(t,e){},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._callbacks=this._callbacks||{};var r=this._callbacks[t];if(r){r=r.slice(0);for(var o=0,i=r.length;i>o;++o)r[o].apply(this,e)}return this},t}());t.eventEmitter=n,n.prototype.addEventListener=n.prototype.on,n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=n.prototype.off}(FlashAir||(FlashAir={}));var __extends=this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},FlashAir;!function(t){var e=function(t){function e(e,n){t.call(this),this.firmwareVersionNumber=1,this.pollingInterval=2e3,this._pausePolling=!1;var s=this;s.Command=new r(this),s.Thumbnail=new o(this),s.Config=new i(this),s.Upload=new a(this),s.mastercode=sessionStorage.getItem("administrator"),s.pollingInterval=n.polling?n.polling===!0?s.pollingInterval:n.polling===!1?0:n.polling:s.pollingInterval,this.setHostAddress(e||"",n.checkHost||!0)}return __extends(e,t),e.prototype.setHostAddress=function(t,e){function n(e){if(/\/$/.test(t)||(t+="/"),r.baseUrl=t,r.firmware=e,e){var n=/(\d+)\.(\d+)\.(\d+)$/.exec(e);n&&(r.firmwareVersionNumber=Number(n[1]))}r.onHostChanged(),r.initWithHost()}void 0===e&&(e=!0);var r=this;if(r.stopPolling(),e)return $.ajax({url:t+"/command.cgi?op=108&TIME="+Date.now(),timeout:3e3}).done(n).fail(function(){r.onHostFailure()}).always(function(){});n();var o=$.Deferred();return o.resolve(),o},e.prototype.initWithHost=function(){var t=this,e=[];e.push(this.browserLanguage()),t.firmwareVersionNumber>=2?e.push(this.Command.IsPhotoShareEnabled().done(function(e){t.photoShareMode=e,t.trigger("fa.photosharemode")})):t.photoShareMode=!1,t.mastercode&&e.push($.ajax({type:"GET",cache:!1,url:"/config.cgi?MASTERCODE="+t.mastercode}).done(function(e){"SUCCESS"==e&&($("#setBtn").show(),t.isAdministrator=!0)})),$.when.apply($,e).then(function(){t.onHostReady()},function(){t.onHostFailure()})},e.prototype.GetFile=function(t){throw"not implemented"},e.prototype.GetFileUrl=function(t){var e;return e="string"==typeof t?t:(t.r_uri||t.Directory)+"\\"+(t.fname||t.Name),e=e.replace("\\","/"),this.baseUrl+(/^\//.test(e)?e.substr(1):e)},e.prototype.onHostChanged=function(){this.trigger("fa.hostchanged")},e.prototype.onHostReady=function(){this.trigger("fa.hostready"),this.startPolling()},e.prototype.onHostFailure=function(){this.trigger("fa.hostfailure")},e.prototype.startPolling=function(){!this.photoShareMode&&this.pollingInterval>0&&!this.timer&&this.poll()},e.prototype.pausePolling=function(){this._pausePolling=!0},e.prototype.resumePolling=function(){this._pausePolling=!1},e.prototype.stopPolling=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},e.prototype.poll=function(){var t=this;if(t._pausePolling)return void(t.timer=setTimeout($.proxy(t.poll,t),t.pollingInterval));var e="fa.polling";t.trigger(e,"connecting"),this.Command.LastUpdatedTimestamp(this.pollingInterval/3).done(function(n){t.trigger(e,"connected"),t.timestamp&&n>t.timestamp&&t.trigger("fa.updated"),t.timestamp=n}).fail(function(){t.trigger(e,"disconnected")}).always(function(){t.timer=t.pollingInterval>0?setTimeout($.proxy(t.poll,t),t.pollingInterval):null})},e.prototype.browserLanguage=function(){var t=this;try{var e;if(e=(navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2),"en"==e)return t.Command.AcceptLanguage().done(function(e){var n;return"zh"==e.substr(17,2)?(n=e.substr(17,5),n=n.toLowerCase(),"zh-cn"==n||"zh-tw"==n?n:(n=e.substr(17,10),n=n.toLowerCase(),n="zh-hans-cn"==n?"zh-cn":"zh-hant-tw"==n?"zh-tw":"zh")):(n=e.substr(17,2),void(t.lang=n))});t.lang="zh"==e?navigator.browserLanguage||navigator.language||navigator.userLanguage:e}catch(n){t.lang="en"}var r=$.Deferred();return r.resolve(),r},e}(t.eventEmitter);t.FlashAirClient=e;var n=function(){function t(t){this.Client=t}return t.prototype.GetBaseUrl=function(){return this.Client.baseUrl},t.prototype.getTimestamp=function(){return Date.now()},t.prototype.GetMethod=function(t,e){t&&(t.TIME=this.getTimestamp());var n={type:"GET",url:this.GetBaseUrl()+this.CgiPath,data:t};return e&&$.extend(n,e),$.ajax(n)},t.prototype.ajax=function(t){return $.ajax(t)},t}();t.CgiHost=n;var r=function(e){function n(t){e.call(this,t),this.CgiPath="command.cgi"}return __extends(n,e),n.prototype.Get=function(t,e,n){var r=$.extend({},e||{},{op:t});return this.GetMethod(r,n).pipe(function(t){return t})},n.prototype.FileList=function(t){return this.Get(100,{DIR:t}).pipe(function(e){t="/"==t?"":t;var r=e.split(/\r?\n/);if("WLANSD_FILELIST"!=r[0])throw"First line is not WLANSD_FILELIST.";for(var o=[],i=1;i<r.length;i++){var a=n.reColumns.exec(r[i]);a&&o.push({r_uri:t,fname:a[1].substring(t.length+1),fsize:Number(a[2]),attr:Number(a[3]),fdate:Number(a[4]),ftime:Number(a[5])})}return o})},n.prototype.FileCount=function(t){return this.Get(101,{DIR:t})},n.prototype.IsUpdated=function(){return this.Get(102).pipe(function(t){return 1==t})},n.prototype.NetworkSSID=function(){return this.Get(104)},n.prototype.NetworkPassword=function(){return this.Get(105)},n.prototype.MAC=function(){return this.Get(106)},n.prototype.AcceptLanguage=function(){return this.Get(107)},n.prototype.FirmwareVersion=function(){return this.Get(108)},n.prototype.ControlImagePath=function(){return this.Get(109)},n.prototype.OperationMode=function(){return this.Get(110)},n.prototype.DeviceTimeout=function(){return this.Get(111)},n.prototype.AppCustomInfo=function(){return this.Get(117)},n.prototype.UploadEnabled=function(){return this.Get(118).pipe(function(t){})},n.prototype.CID=function(){return this.Get(120)},n.prototype.LastUpdatedTimestamp=function(t){return this.Get(121,null,{timeout:t})},n.prototype.GetAvailableSectorInfo=function(){return this.Get(140).pipe(function(t){var e=t.split(/[\/\,]/);return{Free:parseInt(e[0]),Total:parseInt(e[1]),SectorSize:parseInt(e[2])}})},n.prototype.TurnOnPhotoShare=function(e,n){var r={DIR:e,DATE:t.FileInfo.DateTimeToFDATE(n)};return this.Get(200,r).pipe(function(t){return"OK"==t})},n.prototype.TurnOffPhotoShare=function(){return this.Get(201).pipe(function(t){return"OK"==t})},n.prototype.IsPhotoShareEnabled=function(){return this.Get(202).pipe(function(t){return"SHAREMODE"==t})},n.prototype.PhotoShareSSID=function(){return this.Get(203)},n.prototype.WebDAVStatus=function(){return this.Get(220).pipe(function(t){return t})},n.prototype.TimeZone=function(){return this.Get(221).pipe(function(t){return 15*t})},n.reColumns=/^(.+),(\d+),(\d+),(\d+),(\d+)/,n}(n);t.Command=r;var o=function(t){function e(e){t.call(this,e),this.CgiPath="thumbnail.cgi"}return __extends(e,t),e.prototype.GetUrl=function(t){return"string "==typeof t?this.GetBaseUrl()+this.CgiPath+"?"+t:this.GetBaseUrl()+this.CgiPath+"?"+t.r_uri+"/"+t.fname},e}(n);t.Thumbnail=o;var i=function(t){function e(e){t.call(this,e),this.CgiPath="config.cgi",this.CONFIG={}}return __extends(e,t),e.prototype.Get=function(t){return this.GetMethod(t)},e.prototype.Submit=function(t){return this.CONFIG.MASTERCODE=t,this.Get(this.CONFIG).pipe(function(t){return"SUCCESS"==t})},e.prototype.Clear=function(){this.CONFIG={}},e.prototype.setDeviceTimeout=function(t){var e=t;if(6e4>e||e>4294967294)throw"value must be between 60000 and 4294967294.";this.CONFIG.APPAUTOTIME=e},e}(n);t.Config=i;var a=function(t){function e(e){t.call(this,e)}return __extends(e,t),e}(n);t.Upload=a}(FlashAir||(FlashAir={}));
//# sourceMappingURL=flashAirClient.min.js.map